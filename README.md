# RecipeStudio (AvaloniaUI prototype)

Это прототип под твой ТЗ из чата/скринов: таблица точек, расчёты по Excel (UI/CALC/CONST/SAVE) и визуализация траектории.

## Что уже реализовано

- **AvaloniaUI Desktop** (темная стилистика, как на прототипах).
- **Дашборд**: список рецептов из **SQLite** (файл `recipes.sqlite` лежит в папке хранения), создание нового, открытие.
- **Редактор**:
  - таблица (DataGrid) с основными входными колонками + вычисленные поля (пульсы, dX/dY/dZ и т.д.)
  - **пересчет** по формулам из Excel:
    - рекомендованный угол α
    - t (сек), V (мм/мин), рекомендованный расход
    - CALC/SAVE поля: Xr0, dX/dY/dZ, пульсы и частоты
  - **график** (кастомный Control):
    - точки Safe=0/1 (зелёный/циан)
    - линия траектории (оранжевая)
    - пунктир «строки точек»
    - **сглаживание** (Catmull–Rom) между точками
    - **перетаскивание точек** мышью (обновляет R/Z и пересчитывает всё)
  - **анимация инструмента** по траектории (ползунок + play/pause)
- **Настройки**:
  - папка хранения (там лежит `recipes.sqlite`)
  - константы (H_zone, Lz, PulseClamp)
  - графика: opacity (0.05–0.90), толщина линии, включение polyline/spline, сегменты сглаживания, drag
  - сохранение в `%APPDATA%/recipe-studio/settings.json`

## Как собрать и запустить

Нужен .NET SDK 8.0+.

```bash
cd src/RecipeStudio.Desktop
dotnet restore
dotnet run
```

## Формат данных

- Основное хранение: **SQLite** (`recipes.sqlite`).
- Импорт/экспорт: **Excel .xlsx** (лист `Points`, заголовок-колонки фиксированные и header-driven импорт).
- Для совместимости на первом запуске (если база пустая) пробуем импортировать старые `.csv`/TSV рецепты из папки хранения.

## Дальше по развитию

- Подтянуть точные размеры/ограничения из чертежей и отрисовать форму/контейнер более реалистично (с твоих картинок).
- Сделать генерацию preview в Дашборде (рендер графика в PNG).
- Разнести таблицу на вкладки: «Вводные», «Расчетные», «SAVE» (как в Excel).
- Добавить горячие клавиши, undo/redo и более точную симуляцию по времени сегментов.

