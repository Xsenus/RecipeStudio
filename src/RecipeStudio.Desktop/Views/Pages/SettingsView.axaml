<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="RecipeStudio.Desktop.Views.Pages.SettingsView">

  <ScrollViewer>
    <StackPanel Margin="18" Spacing="12">

      <StackPanel>
        <TextBlock Text="Настройки" Classes="h1" />
        <TextBlock Text="Параметры пути, константы и папка хранения рецептов" Classes="muted" />
      </StackPanel>

      <Border Classes="card">
        <StackPanel Spacing="10">
          <TextBlock Text="Хранилище рецептов" FontSize="16" FontWeight="SemiBold" />

          <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto">
            <TextBlock Grid.Row="0" Grid.Column="0" Text="Папка" Classes="muted" />

            <TextBox Grid.Row="1" Grid.Column="0" Text="{Binding RecipesFolder}" />
            <Button Grid.Row="1" Grid.Column="1" Classes="ghost" Click="BrowseFolder_Click" Margin="10,0,0,0">Обзор…</Button>
          </Grid>
        </StackPanel>
      </Border>

      <Border Classes="card">
        <StackPanel Spacing="10">
          <TextBlock Text="Константы" FontSize="16" FontWeight="SemiBold" />
          <TextBlock Text="(по умолчанию значения из Excel CONST)" Classes="muted" />

          <Grid ColumnDefinitions="220,*" RowDefinitions="Auto,Auto,Auto">
            <TextBlock Text="H_zone" VerticalAlignment="Center" />
            <TextBox Grid.Column="1" Text="{Binding HZone}" Margin="10,0,0,0" />

            <TextBlock Grid.Row="1" Text="Lz (длина сопла)" VerticalAlignment="Center" />
            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding Lz}" Margin="10,0,0,0" />

            <TextBlock Grid.Row="2" Text="PulseClamp" VerticalAlignment="Center" />
            <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding PulseClamp}" Margin="10,0,0,0" />
          </Grid>

          <TextBlock Text="(остальные коэффициенты пульсаций также доступны в settings.json)" Classes="muted" />
        </StackPanel>
      </Border>

      <Border Classes="card">
        <StackPanel Spacing="10">
          <TextBlock Text="Графика" FontSize="16" FontWeight="SemiBold" />
          <TextBlock Text="Прозрачность и отображение линий/точек" Classes="muted" />

          <Grid ColumnDefinitions="220,*" RowDefinitions="Auto,Auto,Auto,Auto">
            <TextBlock Text="Opacity (0.05–0.90)" VerticalAlignment="Center" />
            <Slider Grid.Column="1" Minimum="0.05" Maximum="0.90" Value="{Binding PlotOpacity}" Margin="10,0,0,0" />

            <TextBlock Grid.Row="1" Text="Толщина линии" VerticalAlignment="Center" />
            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding PlotStrokeThickness}" Margin="10,0,0,0" />

            <CheckBox Grid.Row="2" Grid.ColumnSpan="2" IsChecked="{Binding PlotShowPolyline}">Показывать ломаную (polyline)</CheckBox>
            <CheckBox Grid.Row="3" Grid.ColumnSpan="2" IsChecked="{Binding PlotShowSmooth}">Показывать сглаженную линию (spline)</CheckBox>
          </Grid>

          <Grid ColumnDefinitions="220,*" RowDefinitions="Auto,Auto">
            <CheckBox Grid.Row="0" Grid.ColumnSpan="2" IsChecked="{Binding PlotShowTargetPoints}">Показывать точки</CheckBox>
            <CheckBox Grid.Row="1" Grid.ColumnSpan="2" IsChecked="{Binding PlotEnableDrag}">Разрешить перетаскивание точек на графике</CheckBox>
          </Grid>

          <Grid ColumnDefinitions="220,*" RowDefinitions="Auto">
            <TextBlock Text="Сегменты сглаживания" VerticalAlignment="Center" />
            <TextBox Grid.Column="1" Text="{Binding SmoothSegmentsPerSpan}" Margin="10,0,0,0" />
          </Grid>

        </StackPanel>
      </Border>

      <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
        <Button Command="{Binding SaveCommand}" Classes="accent">Сохранить</Button>
      </StackPanel>

      <TextBlock Text="Файл настроек: %APPDATA%/recipe-studio/settings.json" Classes="muted" />

    </StackPanel>
  </ScrollViewer>
</UserControl>
